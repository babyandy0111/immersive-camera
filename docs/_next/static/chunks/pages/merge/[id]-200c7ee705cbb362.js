(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[829],{2481:function(e,t){"use strict";var n={format:"image/png",quality:.92,width:void 0,height:void 0,Canvas:void 0,crossOrigin:void 0};t.Z=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t={}),new Promise(function(i){var a=(t=Object.assign({},n,t)).Canvas?new t.Canvas:window.document.createElement("canvas"),r=t.Image||window.Image,o=e.map(function(e){return new Promise(function(n,i){"Object"!==e.constructor.name&&(e={src:e});var a=new r;a.crossOrigin=t.crossOrigin,a.onerror=function(){return i(Error("Couldn't load image"))},a.onload=function(){return n(Object.assign({},e,{img:a}))},a.src=e.src})}),l=a.getContext("2d");i(Promise.all(o).then(function(e){var n=function(n){return t[n]||Math.max.apply(Math,e.map(function(e){return e.img[n]}))};return(a.width=n("width"),a.height=n("height"),e.forEach(function(e){return l.globalAlpha=e.opacity?e.opacity:1,l.drawImage(e.img,e.x||0,e.y||0)}),t.Canvas&&"image/jpeg"===t.format)?new Promise(function(e,n){a.toDataURL(t.format,{quality:t.quality,progressive:!1},function(t,i){if(t){n(t);return}e(i)})}):a.toDataURL(t.format,t.quality)}))})}},2954:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/merge/[id]",function(){return n(8793)}])},8769:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var i=n(5893),a=n(9008),r=n.n(a),o=n(5697),l=n.n(o);function c(e){let{children:t}=e;return(0,i.jsxs)("div",{className:l().container,children:[(0,i.jsxs)(r(),{children:[(0,i.jsx)("title",{children:"新北市議會類 AR 合照系統"}),(0,i.jsx)("meta",{name:"viewport",content:"width=device-width,initial-scale=1,shrink-to-fit=no"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.png"})]}),t]})}},8793:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var i=n(5893),a=n(1163),r=n(5697),o=n.n(r),l=n(8769),c=n(7294),u=n(6770),s=n.n(u),h=n(2481);function d(){let e=(0,a.useRouter)(),[t,n]=(0,c.useState)(""),[r,u]=(0,c.useState)(null),[d,g]=(0,c.useState)(null),f=async e=>{let t=await fetch(e),n=await t.blob(),i="";return await new Promise(e=>{let t=new FileReader;t.readAsDataURL(n),t.onloadend=()=>{e(i=t.result)}}),i},m=e=>{let t=e.split(";base64,"),n=t[0].split(":")[1],i=null==window?void 0:window.atob(t[1]),a=new Uint8Array(i.length);for(let e=0;e<i.length;++e)a[e]=i.charCodeAt(e);return new Blob([a],{type:n})},w=(e,t,n)=>new Promise(i=>{s().imageFileResizer(e,t,n,"PNG",100,0,e=>{i(e)},"base64",t,n)}),v=async()=>{if(!r)return;let e="/images/characters/",n="";n=window.innerWidth>window.innerHeight?e+"land-"+t+".png":e+"port-"+t+".png";let i=await f(n),a=m(i),o=await w(r,1920,1080),l=await w(a,1920,1080);(0,h.Z)([{src:o,x:0,y:0},{src:l,x:0,y:0}]).then(e=>{g(e)})};return(0,c.useEffect)(()=>{e.query.id&&n(e.query.id)},[t]),(0,i.jsx)(l.Z,{children:(0,i.jsxs)("main",{className:o().main,children:[(0,i.jsxs)("div",{className:o().func,children:[(0,i.jsx)("input",{type:"file",onChange:e=>{e.target.files&&u(e.target.files[0])}}),(0,i.jsx)("button",{onClick:v,children:"Upload"})]}),(0,i.jsx)("div",{style:{width:1980,height:1020,backgroundImage:"".concat(d?'url("'.concat(d,'")'):"")},image:d,onClick:()=>{}})]})})}},5697:function(e){e.exports={container:"home_container__U_vei",main:"home_main__yuqk2",func:"home_func__uVVrR",list:"home_list__xGS3_"}},9008:function(e,t,n){e.exports=n(2636)},1163:function(e,t,n){e.exports=n(6885)},6770:function(e){(()=>{"use strict";var t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};t.r(n),t.d(n,{default:()=>a});var i=function(){var e;function t(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t)}return e=[{key:"changeHeightWidth",value:function(e,t,n,i,a,r){return n>i&&(e=Math.round(e*i/n),n=i),e>t&&(n=Math.round(n*t/e),e=t),a&&n<a&&(e=Math.round(e*a/n),n=a),r&&e<r&&(n=Math.round(n*r/e),e=r),{height:e,width:n}}},{key:"resizeAndRotateImage",value:function(e,t,n,i,a){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=document.createElement("canvas"),u=e.width,s=e.height,h=this.changeHeightWidth(s,n,u,t,i,a);l&&(90===l||270===l)?(c.width=h.height,c.height=h.width):(c.width=h.width,c.height=h.height),u=h.width,s=h.height;var d=c.getContext("2d");return d.fillStyle="rgba(0, 0, 0, 0)",d.fillRect(0,0,u,s),d.imageSmoothingEnabled&&d.imageSmoothingQuality&&(d.imageSmoothingQuality="high"),l&&(d.rotate(l*Math.PI/180),90===l?d.translate(0,-c.width):180===l?d.translate(-c.width,-c.height):270===l?d.translate(-c.height,0):0!==l&&360!==l||d.translate(0,0)),d.drawImage(e,0,0,u,s),c.toDataURL("image/".concat(r),o/100)}},{key:"b64toByteArrays",value:function(e,t){t=t||"image/jpeg";for(var n=atob(e.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),i=[],a=0;a<n.length;a+=512){for(var r=n.slice(a,a+512),o=Array(r.length),l=0;l<r.length;l++)o[l]=r.charCodeAt(l);var c=new Uint8Array(o);i.push(c)}return i}},{key:"b64toBlob",value:function(e,t){var n=this.b64toByteArrays(e,t);return new Blob(n,{type:t,lastModified:new Date})}},{key:"b64toFile",value:function(e,t,n){var i=this.b64toByteArrays(e,n);return new File(i,t,{type:n,lastModified:new Date})}},{key:"createResizedImage",value:function(e,n,i,a,r,o,l){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=new FileReader;if(!e)throw Error("File Not Found!");if(e.type&&!e.type.includes("image"))throw Error("File Is NOT Image!");h.readAsDataURL(e),h.onload=function(){var d=new Image;d.src=h.result,d.onload=function(){var h=t.resizeAndRotateImage(d,n,i,u,s,a,r,o),g="image/".concat(a);switch(c){case"blob":l(t.b64toBlob(h,g));break;case"base64":default:l(h);break;case"file":var f=e.name.toString().replace(/(png|jpeg|jpg|webp)$/i,"").concat(a.toString());l(t.b64toFile(h,f,g))}}},h.onerror=function(e){throw Error(e)}}}],function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t,e),t}();let a={imageFileResizer:function(e,t,n,a,r,o,l,c,u,s){return i.createResizedImage(e,t,n,a,r,o,l,c,u,s)}};e.exports=n})()}},function(e){e.O(0,[774,888,179],function(){return e(e.s=2954)}),_N_E=e.O()}]);